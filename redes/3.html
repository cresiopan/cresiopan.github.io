<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2020-09-16 Wed 12:03 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>SMTP y DNS</title>
<meta name="generator" content="Org mode" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="/res/org.css"/>
<link rel="stylesheet" type="text/css" href="../res/org.css"/>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2020 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">

<div id="outline-container-org2f5efbd" class="outline-2">
<h2 id="org2f5efbd"><span class="section-number-2">1</span> <span class="todo TODO">TODO</span> Electronic Mail in the Internet</h2>
<div class="outline-text-2" id="text-1">
<p>
e-mail is an asynchronous communication medium-people send and read messages
when it is convenient for them, without having to coordinate with other
people’s schedules.
</p>

<p>
imagen 2.14
</p>

<p>
We see from this diagram that it has three major components:
</p>
<ul class="org-ul">
<li><code>user agents</code>,</li>
<li><code>mail servers</code>, and</li>
<li><code>Simple Mail Transfer Protocol (SMTP)</code></li>
</ul>

<p>
Alice, sending an e-mail message to a recipient, Bob.
</p>

<p>
User agents allow users to :
</p>
<ul class="org-ul">
<li>read,</li>
<li>reply to,</li>
<li>forward,</li>
<li>save, and</li>
<li>compose</li>
</ul>
<p>
messages.
</p>

<p>
When Alice is finished composing her message, her user agent sends the message
to her mail server, where the message is placed in the mail server’s outgoing
message queue. When Bob wants to read a message, his user agent retrieves the
message from his mailbox in his mail server.
</p>

<p>
Mail servers form the core of the e-mail infrastructure. Each recipient, has a
<code>mailbox</code> located in one of the mail servers. A mailbox manages and maintains
the messages that have been sent to him.
</p>

<p>
A typical message starts its journey in
</p>
<ul class="org-ul">
<li>the sender’s user agent,</li>
<li>travels to the sender’s mail server, and</li>
<li>travels to the recipient’s mail server, and is deposited in the recipient’s
mailbox.</li>
<li>When Bob wants to access the messages in his mailbox, the mail server
containing his mailbox authenticates Bob (with usernames and passwords).</li>
</ul>

<p>
Alice’s mail server must also deal with failures in Bob’s mail server. If
Alice’s server cannot deliver mail to Bob’s server, Alice’s server holds the
message in a <code>message queue</code> and attempts to transfer the message later.
Reattempts are often done every 30 minutes or so; if there is no success after
several days, the server removes the message and notifies the sender (Alice)
with an e-mail message.
</p>

<p>
SMTP is the principal application-layer protocol for Internet electronic
mail. It uses the reliable data transfer service of TCP to transfer mail from
the sender’s mail server to the recipient’s mail server. As with most
application-layer protocols, SMTP has two sides:
</p>
<ul class="org-ul">
<li>a client side, which executes on the sender’s mail server, and</li>
<li>a server side, which executes on the recipient’s mail server.</li>
</ul>

<p>
<b>Both</b> the client and server sides of SMTP run on every mail server. When a
mail server sends mail to other mail servers, it acts as an SMTP client. When
a mail server receives mail from other mail servers, it acts as an SMTP
server.
</p>
</div>

<div id="outline-container-org8638e87" class="outline-3">
<h3 id="org8638e87"><span class="section-number-3">1.1</span> SMTP</h3>
<div class="outline-text-3" id="text-1-1">
<p>
RFC 5321
</p>

<p>
restricts <del>the body (not just the headers) of</del> all mail messages to simple
7-bit ASCII. This restriction made sense in the early 1980s when transmission
capacity was scarce and no one was e mailing large attachments or large
image, audio, or video files. But today, in the multimedia era, the 7-bit
ASCII restriction is a bit of a pain -it requires binary multimedia data to
be encoded to ASCII before being sent over SMTP; and it requires the
corresponding ASCII message to be decoded back to binary after SMTP
transport.
</p>

<p>
Suppose Alice wants to send Bob a simple ASCII message.
</p>
<ol class="org-ol">
<li>Alice invokes her user agent for e-mail, provides Bob’s e-mail address
(for example, bob@someschool.edu ), composes a message, and instructs the
user agent to send the message.</li>
<li>Alice’s user agent sends the message to her mail server, where it is
placed in a message queue.</li>
<li>The client side of SMTP, running on Alice’s mail server, sees the message
in the message queue. It opens a TCP connection to an SMTP server, running
on Bob’s mail server.</li>
<li>After some initial SMTP handshaking, the SMTP client sends Alice’s message
into the TCP connection.</li>
<li>At Bob’s mail server, the server side of SMTP receives the message. Bob’s
mail server then places the message in Bob’s mailbox.</li>
<li>Bob invokes his user agent to read the message at his convenience.</li>
</ol>

<p>
imagen 2.15
</p>

<p>
It is important to observe that SMTP does not normally use intermediate mail
servers for sending mail, even when the two mail servers are located at
opposite ends of the world. If Alice’s server is in Hong Kong and Bob’s
server is in St. Louis, the TCP connection is a direct connection between the
Hong Kong and St. Louis servers. In particular, if Bob’s mail server is down,
the message remains in Alice’s mail server and waits for a new attempt-the
message does not get placed in some intermediate mail server.
</p>

<p>
Let’s now take a closer look at how SMTP transfers a message from a sending
mail server to a receiving mail server.
</p>
<ul class="org-ul">
<li>First, the client SMTP (running on the sending mail server host) has TCP
establish a connection to port 25 at the server SMTP (running on the
receiving mail server host).
<ul class="org-ul">
<li>If the server is down, the client tries again later.</li>
</ul></li>
<li>Once this connection is established, the server and client perform some
application-layer handshaking.
<ul class="org-ul">
<li>During this SMTP handshaking phase, the SMTP client indicates the e-mail
address of the sender (the person who generated the message) and the
e-mail address of the recipient.</li>
</ul></li>
<li>Once the SMTP client and server have introduced themselves to each other,
the client sends the message.</li>
</ul>

<p>
SMTP can count on the reliable data transfer service of TCP to get the
message to the server without errors. The client then repeats this process
over the same TCP connection if it has other messages to send to the server;
otherwise, it instructs TCP to close the connection.
</p>

<p>
exchanged messages between Client (C) with hostname <code>crepes.fr</code> and Server
(S) with hostname <code>hamburger.edu</code>.
</p>

<blockquote>
<p>
S:  220 hamburger.edu
C:  HELO crepes.fr
S:  250 Hello crepes.fr, pleased to meet you
C:  MAIL FROM: &lt;alice@crepes.fr&gt;
S:  250 alice@crepes.fr &#x2026; Sender ok
C:  RCPT TO: &lt;bob@hamburger.edu&gt;
S:  250 bob@hamburger.edu &#x2026; Recipient ok
C:  DATA
S:  354 Enter mail, end with ”.” on a line by itself
C:  Do you like ketchup?
C:  How about pickles?
C:  .
S:  250 Message accepted for delivery
C:  QUIT
S:  221 hamburger.edu closing connection
</p>
</blockquote>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">server</th>
<th scope="col" class="org-left">client</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">220 hamburger.edu</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">HELO crepes.fr</td>
</tr>

<tr>
<td class="org-left">250 Hello crepes.fr, pleased to meet you</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">MAIL FROM: &lt;alice@crepes.fr&gt;</td>
</tr>

<tr>
<td class="org-left">250 alice@crepes.fr &#x2026; Sender ok</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">RCPT TO: &lt;bob@hamburger.edu&gt;</td>
</tr>

<tr>
<td class="org-left">250 bob@hamburger.edu &#x2026; Recipient ok</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">DATA</td>
</tr>

<tr>
<td class="org-left">354 Enter mail, end with ”.” on a line by itself</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Do you like ketchup?</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">How about pickles?</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">.</td>
</tr>

<tr>
<td class="org-left">250 Message accepted for delivery</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">QUIT</td>
</tr>

<tr>
<td class="org-left">221 hamburger.edu closing connection</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
the client issued five commands: HELO (an abbreviation for HELLO), MAIL FROM,
RCPT TO, DATA, and QUIT .
</p>

<p>
The client also sends a line consisting of a single period, which indicates
the end of the message to the server. (In ASCII jargon, each message ends
with CRLF.CRLF , where CR and LF stand for carriage return and line feed,
respectively.) The server issues replies to each command, with each reply
having a reply code and some (optional) explanation.
</p>

<p>
As SMTP uses persistent connections: If the sending mail server has several
messages to send to the same receiving mail server, it can send all of the
messages over the same TCP connection. For each message, the client begins
the process with a new MAIL FROM: crepes.fr , designates the end of message
with an isolated period, and issues QUIT only after all messages have been
sent.
</p>
</div>
</div>

<div id="outline-container-org163a0fc" class="outline-3">
<h3 id="org163a0fc"><span class="section-number-3">1.2</span> Comparison with HTTP</h3>
<div class="outline-text-3" id="text-1-2">
<p>
Both protocols are used to transfer files from one host to another: HTTP
transfers files (also called objects) from a Web server to a Web client
(typically a browser); SMTP transfers files (that is, e-mail messages) from
one mail server to another mail server.  When transferring the files, both
persistent HTTP and SMTP use <code>persistent connections</code>.
</p>

<p>
However, there are important differences.
</p>

<ul class="org-ul">
<li>First, HTTP is mainly a <code>pull protocol</code> - someone loads information on a
Web server and users use HTTP to pull the information from the server at
their convenience. In particular, the TCP connection is initiated by the
machine that wants to receive the file. On the other hand, SMTP is
primarily a <code>push protocol</code> — the sending mail server pushes the file to
the receiving mail server. In particular, the TCP connection is initiated
by the machine that wants to send the file.</li>
<li>A second difference, which we alluded to earlier, is that SMTP requires
each message, including the body of each message, to be in 7-bit ASCII
format. If the message contains characters that are not 7-bit ASCII (for
example, French characters with accents) or contains binary data (such as
an image file), then the message has to be encoded into 7-bit ASCII. HTTP
data does not impose this restriction.</li>
<li>A third important difference concerns how a document consisting of text and
images (along with possibly other media types) is handled. HTTP
encapsulates each object in its own HTTP response message. SMTP places all
of the message’s objects into one message.</li>
</ul>
</div>
</div>

<div id="outline-container-org99065b5" class="outline-3">
<h3 id="org99065b5"><span class="section-number-3">1.3</span> Mail Message Formats</h3>
<div class="outline-text-3" id="text-1-3">
<p>
when an e-mail message is sent from one person to another, a header
containing peripheral information (such as receiver address, return address
and date in ordinary snail-mail letters) precedes the body of the message
itself. This peripheral information is contained in a series of header lines,
which are defined in RFC 5322.
</p>

<p>
RFC 5322 specifies the exact format for mail header lines as well as their
semantic interpretations. As with HTTP, each header line contains readable
text, consisting of a keyword followed by a colon followed by a value.
</p>

<p>
Every header must have a <code>From:</code> header line and a <code>To:</code> header line; a
header may include a <code>Subject:</code> header line as well as other optional header
lines. It is important to note that <b>these header lines are different from
the SMTP commands we studied before</b>. The commands in that section were part
of the <code>SMTP handshaking protocol</code>; the header lines examined in this section
are part of the mail message itself.
</p>

<p>
A typical message header looks like this:
</p>

<pre class="example">
From: alice@crepes.fr
To: bob@hamburger.edu
Subject: Searching for the meaning of life.
</pre>

<p>
After the message header, a blank line follows (CLRF); then the message body
(in ASCII) follows.
</p>


<p>
del articulo sobre smtp en wikipedia
</p>
<blockquote>
<p>
SMTP defines message transport, not the message content. Thus, it defines the
mail envelope and its parameters, such as the envelope sender, but not the
header (except trace information) nor the body of the message itself. STD 10
and RFC 5321 define SMTP (the envelope), while STD 11 and RFC 5322 define the
message (header and body), formally referred to as the Internet Message
Format.
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org690e06f" class="outline-3">
<h3 id="org690e06f"><span class="section-number-3">1.4</span> Mail Access Protocols</h3>
<div class="outline-text-3" id="text-1-4">
<p>
Once SMTP delivers the message from Alice’s mail server to Bob’s mail server,
the message is placed in Bob’s mailbox.
</p>

<p>
today, mail access uses a client-server architecture—the typical <b>user reads
e-mail with a client that executes on the user’s end system</b>.
</p>

<p>
Given that the recipient executes his user agent on his local PC, it is
natural to consider placing a mail server on his local PC as well. With this
approach, the sender's mail server would dialogue directly with the
receiver’s PC.
</p>

<p>
However, There is a problem with this approach. Recall that a mail server
manages mailboxes and runs the client and server sides of SMTP. If the
recipient's mail server were to reside on his local PC, then it would have to
remain always on, and connected to the Internet, in order to receive new
mail, which can arrive at any time.
</p>

<p>
This is impractical for many Internet users. Instead, a typical user runs a
user agent on the local PC but accesses its mailbox stored on an <code>always-on</code>
<code>shared</code> mail server typically maintained by the user’s ISP.
</p>

<p>
Now let’s consider the path an e-mail message takes when it is sent from
Alice to Bob. We just learned that at some point along the path the e-mail
message needs to be deposited in Bob’s mail server. This could be done simply
by having Alice’s user agent send the message directly to Bob’s mail
server. And this could be done with SMTP—indeed, SMTP has been designed for
pushing e-mail from one host to another. However, typically the sender’s user
agent does not dialogue directly with the recipient’s mail server. Instead,
as shown in Figure 2.16, Alice’s user agent uses SMTP to push the e-mail
message into her mail server, then Alice’s mail server uses SMTP (as an SMTP
client) to relay the e-mail message to Bob’s mail server. Why the two-step
procedure? Primarily because without relaying through Alice’s mail server,
Alice’s user agent doesn’t have any recourse to an unreachable destination
mail server. By having Alice first deposit the e-mail in her own mail server,
Alice’s mail server can repeatedly try to send the message to Bob’s mail
server, say every 30 minutes, until Bob’s mail server becomes operational.
</p>

<p>
imagen 2.16
</p>

<p>
<b>How does a recipient like Bob, running a user agent on his local PC, obtain
his messages, which are sitting in a mail server within Bob’s ISP?</b> Note that
Bob’s user agent can’t use SMTP to obtain the messages because obtaining the
messages is a pull operation, whereas SMTP is a push protocol. special mail
access protocol that transfers messages from Bob’s mail server to his local
PC. There are currently a number of popular mail access protocols, including
<code>Post Office Protocol—Version 3 (POP3)</code>, <code>Internet Mail Access Protocol
   (IMAP)</code>, and <code>HTTP</code>.
</p>
</div>

<div id="outline-container-org5a1c408" class="outline-4">
<h4 id="org5a1c408"><span class="section-number-4">1.4.1</span> POP3</h4>
<div class="outline-text-4" id="text-1-4-1">
<p>
[RFC 1939]
</p>

<p>
arquitectura cliente servidor, donde el user-agent es el cliente.
</p>

<p>
POP3 comienza cuando el user-agent abre una conexion tcp con el mail
server en el puerto 110.
</p>

<p>
luego de establecer la conexion, pop3 inicia 3 fases:
</p>
<ol class="org-ol">
<li>autorizacion: el user-agent envia un nombre de usuario y contraseña para
autenticar al usuario. Comandos:  <code>user &lt;username&gt;</code>, <code>pass &lt;password&gt;</code></li>

<li>Transaccion: el user-agent retira los mensajes; tambien puede
marcar/desmarcar mensajes para eliminarlos y obtener estadisticas del
mail. Comandos: <code>list</code>, <code>retr</code>, <code>dele</code>, <code>quit</code>. El user-agent puede ser
configurado para:
<ul class="org-ul">
<li><p>
<code>Download and delete</code>
</p>
<pre class="example">
C: list
S: 1 498
S: 2 912
S: .
C: retr 1
S: (blah blah ...
S: .................
S: ..........blah)
S: .
C: dele 1
C: retr 2
S: (blah blah ...
S: .................
S: ..........blah)
S: .
C: dele 2
C: quit
S: +OK POP3 server signing off
</pre>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">Servidor</td>
<td class="org-left">Cliente</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">list</td>
</tr>

<tr>
<td class="org-left">1 498</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">2 912</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">.</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">retr 1</td>
</tr>

<tr>
<td class="org-left">(blah blah &#x2026;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#x2026;&#x2026;&#x2026;&#x2026;&#x2026;..</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#x2026;&#x2026;&#x2026;.blah)</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">.</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">dele 1</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">retr 2</td>
</tr>

<tr>
<td class="org-left">(blah blah &#x2026;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#x2026;&#x2026;&#x2026;&#x2026;&#x2026;..</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#x2026;&#x2026;&#x2026;.blah)</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">.</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">dele 2</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">quit</td>
</tr>

<tr>
<td class="org-left">+OK POP3 server signing off</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
A problem with this download-and-delete mode the recipient may want to
access his mail messages from multiple machines. The mode partitions the
user’s mail messages over the machines; in particular, if the user first
reads a message on his office PC, he will not be able to reread the
message from his portable at home later in the evening. In the
download-and-keep mode, the user agent leaves the messages on the mail
server after downloading them. In this case, the user can reread
messages from different machines;
</p></li>

<li><code>Download and keep</code></li>
</ul></li>

<li><code>Update</code>: ocurre luego de que el cliente ejecuta el comando <code>quit</code>,
finalizando la sesion POP3. en este momento, el mail server elimina los
mensajes que fueron marcados para borrarse.</li>
</ol>

<p>
El servidor responde a cada comando con una respuesta:
</p>
<ul class="org-ul">
<li><code>+OK</code>, para indicar que el comando fue exitoso</li>
<li><code>-ERR</code>, para indicar que hubo un error</li>
</ul>

<p>
Durante la sesion, el server mantiene el estado de la sesion. lleva registro
de los mensajes marcados para su eliminacion, etc. sin embargo no se
mantiene un estado entre sesiones.
</p>
</div>
</div>

<div id="outline-container-org01cb20a" class="outline-4">
<h4 id="org01cb20a"><span class="section-number-4">1.4.2</span> IMAP</h4>
<div class="outline-text-4" id="text-1-4-2">
<p>
[RFC 3501]
</p>

<p>
IMAP fue creado para proveer al usuario de herramientas para crear carpetas
remotas y asignar mensajes a dichas carpetas, lo que pop3 no puede hacer.
</p>

<p>
en imap, e- servidor asocia cada mensaje con una carpeta. por defecto se
asocia a INBOX.
</p>

<p>
The IMAP protocol provides commands to allow users to create folders and
move messages from one folder to another.
</p>

<p>
IMAP also provides commands that allow users to search remote folders for
messages matching specific criteria.
</p>

<p>
Note that, unlike POP3, an IMAP server maintains user state information
across IMAP sessions—for example, the names of the folders and which
messages are associated with which folders.
</p>

<p>
Another important feature of IMAP is that it has commands that <b>permit a
user agent to obtain components of messages</b>. For example, a user agent can
obtain just the message header of a message or just one part of a multipart
MIME message. This feature is useful when there is a low-bandwidth
connection (for example, a slow-speed modem link) between the user agent and
its mail server. With a low-bandwidth connection, the user may not want to
download all of the messages in its mailbox, particularly avoiding long
messages that might contain, for example, an audio or video clip.
</p>
</div>
</div>

<div id="outline-container-org7602f3b" class="outline-4">
<h4 id="org7602f3b"><span class="section-number-4">1.4.3</span> Web-based E-Mail</h4>
<div class="outline-text-4" id="text-1-4-3">
<p>
More and more users today are sending and accessing their e-mail through
their Web browsers.
</p>

<p>
Hotmail introduced Web-based access in the mid 1990s.
</p>

<p>
With this service, <b>the user agent is an ordinary Web browser</b>, and the user
communicates with its remote mailbox via HTTP. When a recipient, such as
Bob, wants to access a message in his mailbox, the e-mail message is sent
from Bob’s mail server to Bob’s browser using the HTTP protocol rather than
the POP3 or IMAP protocol.  When a sender, such as Alice, wants to send an
e-mail message, the e-mail message is sent from her browser to her mail
server over HTTP rather than over SMTP. Alice’s mail server, however, still
sends messages to, and receives messages from, other mail servers using
SMTP.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org4beb0db" class="outline-2">
<h2 id="org4beb0db"><span class="section-number-2">2</span> <span class="todo TODO">TODO</span> DNS - The Internet's Directory Service</h2>
<div class="outline-text-2" id="text-2">
<p>
[RFC 1034] [RFC 1035] +
</p>

<p>
Internet hosts can be identified in many ways. One identifier for a host is
its <code>hostname</code> . Hostnames — such as www.facebook.com, www.google.com ,
gaia.cs.umass.edu —are mnemonic and are therefore appreciated by humans.
</p>

<p>
However, hostnames provide little, if any, information about the location
within the Internet of the host. (A hostname such as www.eurecom.fr , which
ends with the country code .fr , tells us that the host is probably in France,
but doesn’t say much more.) Furthermore, because hostnames can consist of
variable-length alphanumeric characters, they would be difficult to process by
routers. For these reasons, hosts are also identified by so-called <code>IP
  addresses</code>.
</p>

<p>
An IP address consists of four bytes and has a rigid hierarchical structure.
the bytes expressed in decimal notation from 0 to 255. An IP address is
hierarchical because as we scan the address from left to right, we obtain more
and more specific information about where the host is located in the Internet
(that is, within which network, in the network of networks).
</p>
</div>

<div id="outline-container-org82f6bd2" class="outline-3">
<h3 id="org82f6bd2"><span class="section-number-3">2.1</span> Services provided by DNS</h3>
<div class="outline-text-3" id="text-2-1">
<p>
People prefer the more mnemonic hostname identifier, while routers prefer
fixed-length, hierarchically structured IP addresses. In order to reconcile
these preferences, we need a directory service that translates hostnames to
IP addresses. This is the main task of the Internet’s <code>domain name system
   (DNS)</code>. The DNS is
</p>
<ol class="org-ol">
<li>a distributed database implemented in a hierarchy of DNS servers, and</li>
<li>an application-layer protocol that allows hosts to query the distributed
database. The DNS servers are often UNIX machines running the Berkeley
Internet Name Domain (BIND) software [BIND 2016]. The DNS protocol runs
over UDP and uses port 53.</li>
</ol>

<p>
DNS is commonly employed by other application-layer protocols—including HTTP
and SMTP to translate user-supplied hostnames to IP addresses. As an example,
consider what happens when a browser (that is, an HTTP client), running on
some user’s host, requests the URL www.someschool.edu/index.html . In order
for the user’s host to be able to send an HTTP request message to the Web
server www.someschool.edu , the user’s host must first obtain the IP address
of www.someschool.edu . This is done as follows.
</p>
<ol class="org-ol">
<li>The same user machine runs the client side of the DNS application.</li>
<li>The browser extracts the hostname, www.someschool.edu , from the URL and
passes the hostname to the client side of the DNS application.</li>
<li>The DNS client sends a query containing the hostname to a DNS server.</li>
<li>The DNS client eventually receives a reply, which includes the IP address
for the hostname.</li>
<li>Once the browser receives the IP address from DNS, it can initiate a TCP
connection to the HTTP server process located at port 80 at that IP
address.</li>
</ol>

<p>
DNS provides a few other important services in addition to translating
hostnames to IP addresses:
</p>

<dl class="org-dl">
<dt>Host aliasing</dt><dd>A host with a complicated hostname can have one or more
alias names. For example, a hostname such as
relay1.west-coast.enterprise.com could have, say, two
aliases such as enterprise.com and www.enterprise.com . In
this case, the hostname relay1.west-coast.enterprise.com
is said to be a <code>canonical hostname</code>. <code>Alias hostnames</code>,
when present, are typically more mnemonic than canonical
hostnames. DNS can be invoked by an application to obtain
the canonical hostname for a supplied alias hostname as
well as the IP address of the host.</dd>
<dt>Mail server aliasing</dt><dd>For obvious reasons, it is highly desirable that
e-mail addresses be mnemonic. For example, if Bob has an account with
Yahoo Mail, Bob’s e-mail address might be as simple as
bob@yahoo.mail. However, the hostname of the Yahoo mail server is more
complicated and much less mnemonic than simply yahoo.com (for example,
the canonical hostname might be something like
relay1.west-coast.yahoo.com ). DNS can be invoked by a mail application
to obtain the canonical hostname for a supplied alias hostname as well
as the IP address of the host.  In fact, the MX record (see below)
permits a company’s mail server and Web server to have identical
(aliased) hostnames; for example, a company’s Web server and mail server
can both be called enterprise.com.
<dl class="org-dl">
<dt>Load distribution</dt><dd>DNS is also used to perform load distribution
among replicated servers, such as replicated Web servers. Busy
sites, such as cnn.com, are replicated over multiple servers, with
each server running on a different end system and each having a
different IP address. For replicated Web servers, a set of IP
addresses is thus associated with one canonical hostname. The DNS
database contains this set of IP addresses. When clients make a DNS
query for a name mapped to a set of addresses, the server responds
with the entire set of IP addresses, but rotates the ordering of
the addresses within each reply. Because a client typically sends
its HTTP request message to the IP address that is listed first in
the set, DNS rotation distributes the traffic among the replicated
servers. DNS rotation is also used for e-mail so that multiple mail
servers can have the same alias name. Also, content distribution
companies such as Akamai have used DNS in more sophisticated ways
to provide Web content distribution.</dd>
</dl></dd>
</dl>

<p>
PRINCIPLES IN PRACTICE
DNS: CRITICAL NETWORK FUNCTIONS VIA THE CLIENT-SERVER PARADIGM
</p>
<blockquote>
<p>
Like HTTP, FTP, and SMTP, the DNS protocol is an application-layer protocol
since it (1) runs between communicating end systems using the client-server
paradigm and (2) relies on an underlying end-to-end transport protocol to
transfer DNS messages between communicating end systems. In another sense,
however, the role of the DNS is quite different from Web, file transfer, and
e-mail applications. Unlike these applications, the DNS is not an application
with which a user directly interacts. Instead, the DNS provides a core
Internet function—namely, translating hostnames to their underlying IP
addresses, for user applications and other software in the Internet. We noted
that much of the complexity in the Internet architecture is located at the
“edges” of the network. The DNS, which implements the critical name-to-
address translation process using clients and servers located at the edge of
the network, is yet another example of that design philosophy.
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org46eaa36" class="outline-3">
<h3 id="org46eaa36"><span class="section-number-3">2.2</span> Overview of How DNS Works</h3>
<div class="outline-text-3" id="text-2-2">
<p>
hostname-to-IP-address translation service.
</p>

<p>
Suppose that some application running in a user’s host needs to translate a
hostname to an IP address. The application will invoke the client side of
DNS, specifying the hostname that needs to be translated. DNS in the user’s
host then takes over, sending a query message into the network. All DNS query
and reply messages are sent within UDP datagrams to port 53. After a delay,
ranging from milliseconds to seconds, DNS in the user’s host receives a DNS
reply message that provides the desired mapping. This mapping is then passed
to the invoking application. Thus, from the perspective of the invoking
application in the user’s host, DNS is a black box providing a simple,
straightforward translation service. But in fact, the black box that
implements the service is complex, consisting of a large number of DNS
servers distributed around the globe, as well as an application-layer
protocol that specifies how the DNS servers and querying hosts communicate.
</p>

<p>
A simple design for DNS would have <b>one DNS server</b> that contains all the
mappings. Although the simplicity of this design is attractive, it is
inappropriate for today’s Internet, with its vast (and growing) number of
hosts. The problems with a centralized design include:
</p>
<dl class="org-dl">
<dt>A single point of failure</dt><dd>If the DNS server crashes, so does the entire
Internet!</dd>
<dt>Traffic volume</dt><dd>A single DNS server would have to handle all DNS queries
(for all the HTTP requests and e-mail messages generated
from hundreds of millions of hosts).</dd>
<dt>Distant centralized database</dt><dd>A single DNS server cannot be “close to”
all the querying clients. If we put the single DNS server in New York
City, then all queries from Australia must travel to the other side of
the globe, perhaps over slow and congested links. This can lead to
significant delays.</dd>
<dt>Maintenance</dt><dd>The single DNS server would have to keep records for all
Internet hosts. Not only would this centralized database be
huge, but it would have to be updated frequently to account
for every new host.</dd>
</dl>

<p>
a single DNS server simply doesn’t scale
</p>
</div>

<div id="outline-container-org1b85b71" class="outline-4">
<h4 id="org1b85b71"><span class="section-number-4">2.2.1</span> A Distributed, Hierarchical Database</h4>
<div class="outline-text-4" id="text-2-2-1">
<p>
In order to deal with the issue of scale, the DNS uses a large number of
servers, organized in a hierarchical fashion and distributed around the
world. No single DNS server has all of the mappings for all of the hosts in
the Internet. Instead, the mappings are distributed across the DNS
servers. To a first approximation, there are three classes of DNS servers—
<code>root</code> DNS servers, <code>top-level domain (TLD)</code> DNS servers, and
<code>authoritative</code> DNS servers.
</p>

<p>
imagen 2.17
</p>

<p>
suppose a DNS client wants to determine the IP address for the hostname
www.amazon.com.
</p>

<p>
The client first contacts one of the root servers, which returns IP
addresses for TLD servers for the top-level domain com . The client then
contacts one of these TLD servers, which returns the IP address of an
authoritative server for amazon.com . Finally, the client contacts one of
the authoritative servers for amazon.com , which returns the IP address for
the hostname www.amazon.com . We’ll soon examine this DNS lookup process in
more detail. But let’s first take a closer look at these three classes of
DNS servers:
</p>

<dl class="org-dl">
<dt>Root DNS servers</dt><dd>There are over 400 root name servers scattered all
over the world. These root name servers are managed by 13 different
organizations. Root name servers provide the IP addresses of the TLD
servers.</dd>
<dt>Top-level domain (TLD) servers</dt><dd>For each of the top-level domains —
top-level domains such as com, org, net, edu, and gov, and all of the
country top-level domains such as uk, fr, ca, and jp — there is TLD
server (or server cluster). The company Verisign Global Registry
Services maintains the TLD servers for the com top-level domain, and
the company Educause maintains the TLD servers for the edu top-level
domain. TLD servers provide the IP addresses for authoritative DNS
servers.</dd>
<dt>Authoritative DNS servers</dt><dd>Every organization with publicly accessible
hosts (such as Web servers and mail servers) on the Internet must
provide publicly accessible DNS records that map the names of those
hosts to IP addresses. An organization’s authoritative DNS server
houses these DNS records. An organization can choose to implement its
own authoritative DNS server to hold these records; alternatively, the
organization can pay to have these records stored in an authoritative
DNS server of some service provider. Most universities and large
companies implement and maintain their own primary and secondary
(backup) authoritative DNS server.</dd>
</dl>


<p>
The root, TLD, and authoritative DNS servers all belong to the hierarchy of
DNS servers.
</p>

<p>
There is another important type of DNS server called the <code>local DNS
    server</code>. A local DNS server does not strictly belong to the hierarchy of
servers but is nevertheless central to the DNS architecture. Each ISP—such
as a residential ISP or an institutional ISP—has a local DNS server (also
called a default name server). When a host connects to an ISP, the ISP
provides the host with the IP addresses of one or more of its local DNS
servers. When a host makes a DNS query, the query is sent to the local DNS
server, which acts a proxy, forwarding the query into the DNS server
hierarchy
</p>

<p>
Let’s take a look at a simple example. Suppose the host cse.nyu.edu desires
the IP address of gaia.cs.umass.edu . Also suppose that NYU’s ocal DNS
server for cse.nyu.edu is called dns.nyu.edu and that an authoritative DNS
server for gaia.cs.umass.edu is called dns.umass.edu . The host cse.nyu.edu
first sends a DNS query message to its local DNS server, dns.nyu.edu . The
query message contains the hostname to be translated, namely,
gaia.cs.umass.edu . The local DNS server forwards the query message to a
root DNS server. The root DNS server takes note of the edu suffix and
returns to the local DNS server a list of IP addresses for TLD servers
responsible for edu . The local DNS server then resends the query message to
one of these TLD servers. The TLD server takes note of the umass.edu suffix
and responds with the IP address of the authoritative DNS server for the
University of Massachusetts, namely, dns.umass.edu . Finally, the local DNS
server resends the query message directly to dns.umass.edu , which responds
with the IP address of gaia.cs.umass.edu . Note that in this example, in
order to obtain the mapping for one hostname, eight DNS messages were sent:
four query messages and four reply messages!
</p>

<p>
imagen 2.19
</p>

<p>
Our previous example assumed that the TLD server knows the authoritative DNS
server for the hostname. In general this not always true. Instead, the TLD
server may know only of an intermediate DNS server, which in turn knows the
authoritative DNS server for the hostname.
</p>

<pre class="example">
For example, suppose again that the University of Massachusetts has a DNS
server for the university, called dns.umass.edu . Also suppose that each of
the departments at the University of Massachusetts has its own DNS server,
and that each departmental DNS server is authoritative for all hosts in the
department. In this case, when the intermediate DNS server, dns.umass.edu ,
receives a query for a host with a hostname ending with cs.umass.edu , it
returns to dns.nyu.edu the IP address of dns.cs.umass.edu , which is
authoritative for all hostnames ending with cs.umass.edu .  The local DNS
server dns.nyu.edu then sends the query to the authoritative DNS server,
which returns the desired mapping to the local DNS server, which in turn
returns the mapping to the requesting host. In this case, a total of 10 DNS
messages are sent!
</pre>

<p>
The example shown in Figure 2.19 makes use of both <code>recursive queries</code> and
<code>iterative queries</code>. The query sent from cse.nyu.edu to dns.nyu.edu is a
recursive query, since the query asks dns.nyu.edu to obtain the mapping on
its behalf. But the subsequent three queries are iterative since all of the
replies are directly returned to dns.nyu.edu . In theory, any DNS query can
be iterative or recursive.
</p>

<p>
<b>For example, Figure 2.20 shows a DNS query chain for which all of the
queries are recursive</b>. <b>In practice, the queries typically follow the
pattern in Figure 2.19</b>. <b>The query from the requesting host to the local
DNS server is recursive, and the remaining queries are iterative</b>
</p>

<p>
imagen 2.20
</p>
</div>
</div>

<div id="outline-container-org4ba2126" class="outline-4">
<h4 id="org4ba2126"><span class="section-number-4">2.2.2</span> DNS Caching</h4>
<div class="outline-text-4" id="text-2-2-2">
<p>
DNS caching improves the delay performance and reduces the number of DNS
messages.
</p>

<p>
La idea es: en una cadena de queries, cuando un server DNS recibe una
respuesta DNS (contenieno, por ejemplo, un mapeo de un hostname a una
direccion IP), este lo puede cachear el mapeo a su memoria local. Si un par
(hostname, IP) esta cacheado en el servidor DNS y otra query llega al
servidor por el mismo hostname, el servidor puede proveer la direccion IP
deseada, incluso si el servidor no es autoritativo para el hostname. Dado
que los mapeos no son permanentes, los servidores DNS descartan la
informacion cacheada luego de un cierto periodo de tiempo.
</p>

<p>
Un servidor DNS local puede cachear tambien las direcciones IP de servidores
TLD, pudiendo saltar sobre el servidor DNS root en la query.
</p>
</div>
</div>
</div>

<div id="outline-container-org9cda414" class="outline-3">
<h3 id="org9cda414"><span class="section-number-3">2.3</span> Registros DNS y Mensajes</h3>
<div class="outline-text-3" id="text-2-3">
<p>
Los servidores DNS que en su conjunto implementan la base de datos distribuida
de DNS, almacenan <code>resource records (RRs)</code>, incluyendo RRs que proveen mapeos
(hostname, IP). Cada respuesta DNS lleva consigo uno o mas RRs.
</p>

<p>
Un resource record es una 4-upla que contiene los campos
</p>
<pre class="example">
(Name, Value, Type, TTL)
</pre>

<p>
<code>TTL</code> es el tiempo de vida del resource record. Determina cuándo un RR
debería ser removido del cache.
</p>

<p>
Los significados de <code>Name</code> y <code>Value</code> dependen de <code>Type</code>:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">Type</td>
<td class="org-left">Name</td>
<td class="org-left">Value</td>
</tr>

<tr>
<td class="org-left">A</td>
<td class="org-left">hostname</td>
<td class="org-left">IP address</td>
</tr>

<tr>
<td class="org-left">NS</td>
<td class="org-left">domain</td>
<td class="org-left">hostname de servidor DNS autoritativo</td>
</tr>

<tr>
<td class="org-left">CNAME</td>
<td class="org-left">hostname alias</td>
<td class="org-left">hostname canonico</td>
</tr>

<tr>
<td class="org-left">MX</td>
<td class="org-left">hostname alias</td>
<td class="org-left">hostname canonico de un mail server</td>
</tr>
</tbody>
</table>

<ul class="org-ul">
<li>If Type=A , then Name is a hostname and Value is the IP address for the
hostname. Thus, a Type A record provides the standard hostname-to-IP
address mapping. As an example, <code>( relay1.bar.foo.com , 145.37.93.126, A)</code>
is a Type A record.</li>
<li>If Type=NS , then Name is a domain (such as foo.com ) and Value is the
hostname of an authoritative DNS server that knows how to obtain the IP
addresses for hosts in the domain. This record is used to route DNS queries
further along in the query chain. As an example, <code>( foo.com , dns.foo.com ,
     NS)</code> is a Type NS record.</li>
<li>If Type=CNAME , then Value is a canonical hostname for the alias hostname
Name . This record can provide querying hosts the canonical name for a
hostname. As an example, <code>( foo.com , relay1.bar.foo.com , CNAME)</code> is a
CNAME record.</li>
<li>If Type=MX , then Value is the canonical name of a mail server that has an
alias hostname Name .  As an example, <code>( foo.com , mail.bar.foo.com , MX)</code>
is an MX record. MX records allow the hostnames of mail servers to have
simple aliases. Note that by using the MX record, a company can have the
same aliased name for its mail server and for one of its other servers
(such as its Web server). To obtain the canonical name for the mail server,
a DNS client would query for an MX record; to obtain the canonical name for
the other server, the DNS client would query for the CNAME record.</li>
</ul>


<p>
Si un servidor DNS es autoritativo para un hostname particular, éste tendrá
un registro de Tipo A para el hostname. (Incluso si el servidor DNS no es
autoritativo, puede contener un registro de Tipo A en su cache.)
</p>

<p>
Si el servidor no es autoritativo para un hostname, tendrá un registro Tipo
NS para el dominio que incluye al hostname. También tendrá un registro Tipo A
que provee la IP del servidor DNS en el campo Value del registro NS.
</p>
</div>

<div id="outline-container-orge21eafb" class="outline-4">
<h4 id="orge21eafb"><span class="section-number-4">2.3.1</span> Mensajes DNS</h4>
<div class="outline-text-4" id="text-2-3-1">
<p>
Existen dos tipos de mensajes DNS, query y response. Ambos tipos tienen el
mismo formato.
</p>

<ul class="org-ul">
<li>Los primeros 12 Bytes son de header section:
<ul class="org-ul">
<li>Número de 16 bits que identifica el tipo de query. Es copiado en el
mensaje de respuesta de la query, permitiendo que el cliente pueda
relacionar respuestas recibidas con búsquedas enviadas.</li>
<li>Varios flags. Pueden indicar si el mensaje es query o reponse, si la
respuesta en enviada por un servidor autoritativo, si se desea una query
recursiva, si el servidor DNS soporta recursion o no.</li>
<li>4 campos que indican la cantidad de ocurrencias de los tipos de
secciones de datos que le siguen al header.</li>
</ul></li>

<li>The <code>question section</code> contains information about the query that is being
made. This section includes (1) a name field that contains the name that
is being queried, and (2) a type field that indicates the type of question
being asked about the name—for example, a host address associated with a
name (Type A) or the mail server for a name (Type MX).</li>
<li>In a reply from a DNS server, the <code>answer section</code> contains the resource
records for the name that was originally queried. Recall that in each
resource record there is the Type (for example, A, NS, CNAME, and MX), the
Value , and the TTL. A reply can return multiple RRs in the answer, since
a hostname can have multiple IP addresses (for example, for replicated Web
servers, as discussed earlier in this section).</li>
<li>The <code>authority section</code> contains records of other authoritative servers.</li>
<li>The <code>additional section</code> contains other helpful records. For example, the
answer field in a reply to an MX query contains a resource record
providing the canonical hostname of a mail server. The additional section
contains a Type A record providing the IP address for the canonical
hostname of the mail server.</li>
</ul>
</div>
</div>

<div id="outline-container-orge4bf647" class="outline-4">
<h4 id="orge4bf647"><span class="section-number-4">2.3.2</span> Inserting Records into the DNS Database</h4>
<div class="outline-text-4" id="text-2-3-2">
<p>
how records get into the database in the first place?
</p>

<p>
Suppose you have just created an exciting new startup company called Network
Utopia. The first thing you’ll surely want to do is register the domain name
networkutopia.com at a registrar. A <code>registrar</code> is a commercial entity that
verifies the uniqueness of the domain name, enters the domain name into the
DNS database (as discussed below), and collects a small fee from you for its
services. Prior to 1999, a single registrar, Network Solutions, had a
monopoly on domain name registration for com , net , and org domains. But
now there are many registrars competing for customers, and the Internet
Corporation for Assigned Names and Numbers (ICANN) accredits the various
registrars. A complete list of accredited registrars is available at
<a href="http://www.internic.net">http://www.internic.net</a>.
</p>

<p>
When you register the domain name networkutopia.com with some registrar, you
also need to provide the registrar with the names and IP addresses of your
primary and secondary authoritative DNS servers. Suppose the names and IP
addresses are dns1.networkutopia.com , dns2.networkutopia.com ,
<code>212.2.212.1</code>, and <code>212.212.212.2</code>. For each of these two authoritative DNS
servers, the registrar would then make sure that a Type NS and a Type A
record are entered into the TLD com servers. Specifically, for the primary
authoritative server for networkutopia.com , the registrar would insert the
following two resource records into the DNS system:
</p>

<pre class="example">
(networkutopia.com, dns1.networkutopia.com, NS)
(dns1.networkutopia.com, 212.212.212.1, A)
</pre>

<p>
You’ll also have to make sure that the Type A resource record for your Web
server www.networkutopia.com and the Type MX resource record for your mail
server mail.networkutopia.com are entered into your authoritative DNS
servers.
</p>

<p>
Once all of these steps are completed, people will be able to visit your Web
site and send e-mail to the employees at your company.
</p>

<pre class="example">
Suppose Alice in Australia wants to view the Web page www.networkutopia.com.
As discussed earlier, her host will first send a DNS query to her local
DNS server. The local DNS server will then contact a TLD com server. (The
local DNS server will also have to contact a root DNS server if the address
of a TLD com server is not cached.) This TLD server contains the Type NS and
Type A resource records listed above, because the registrar had these
resource records inserted into all of the TLD com servers. The TLD com
server sends a reply to Alice’s local DNS server, with the reply containing
the two resource records. The local DNS server then sends a DNS query to
212.212.212.1 , asking for the Type A record corresponding to
www.networkutopia.com . This record provides the IP address of the desired
Web server, say, 212.212.71.4 , which the local DNS server passes back to
Alice’s host. Alice’s browser can now initiate a TCP connection to the host
212.212.71.4 and send an HTTP request over the connection.
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
Last update: 2020-09-16 12:03
</div>
</body>
</html>
